import{T as q}from"./TabComponent-Wa1QOOeB.js";import{s as B,r as g,x as C,_,o as n,c as i,a as e,p as x,v as I,i as S,t as a,F as D,k as U,g as E,d as F,e as A,f as M,b as N,z as V,w as P,q as $}from"./index-BWaTWCz4.js";import{a as G,T as L}from"./TableComponent-Y_T7t8Hu.js";import{u as Q}from"./ticket-store-DIx0HmPG.js";const T=B("order",()=>{const k=g([]),t=g(null),m=g(null);return{orders:k,orderDetails:t,errorMessage:m,createOrder:async p=>{var d,o;try{const s=await C.post("/orders",p);return k.value.push(s.data),s.data}catch(s){throw m.value=((o=(d=s.response)==null?void 0:d.data)==null?void 0:o.message)||"Failed to create order.",s}},getOrderByEmailAndOrderId:async(p,d)=>{var o,s;try{const b=await C.get(`/orders/${p}/${d}`);return t.value=b.data,b.data}catch(b){throw m.value=((s=(o=b.response)==null?void 0:o.data)==null?void 0:s.message)||`Failed to fetch order with ID: ${d}`,b}},updateOrderStatus:async(p,d)=>{var o,s;try{const w=(await C.put(`/orders/${p}/status`,d)).data,h=k.value.findIndex(O=>O.id===p);return h!==-1&&(k.value[h]=w),w}catch(b){throw m.value=((s=(o=b.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to update the order status.",b}},getOrdersByEmail:async p=>{var d,o;try{const s=await C.get(`/orders/${p}`);return k.value=s.data,s.data}catch(s){throw m.value=((o=(d=s.response)==null?void 0:d.data)==null?void 0:o.message)||`Failed to fetch orders for email: ${p}`,s}}}}),R={setup(){const k=T(),t=g(""),m=g(""),r=g(null),c=g(null);return{email:t,orderId:m,orderData:r,errorMessage:c,fetchOrder:async()=>{var o,s;if(!t.value||!m.value){c.value="Both Email and Order ID are required.",r.value=null;return}try{const b=await k.getOrderByEmailAndOrderId(t.value,m.value);r.value=b,c.value=null}catch(b){c.value=((s=(o=b.response)==null?void 0:o.data)==null?void 0:s.message)||"Failed to fetch order. Please try again.",r.value=null}},clearOrder:()=>{r.value=null,c.value=null,t.value="",m.value=""},getOrderStatus:o=>["Pending","Completed","Canceled"][o]||"Unknown",formatDate:o=>{const s={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(o).toLocaleDateString(void 0,s)}}}},j={class:"mb-4"},z={key:0,class:"mt-6 p-4 border border-gray-300 rounded"},H=["href"],J={class:"mt-4"},K=["href"],W={key:1,class:"mt-4 text-red-500"};function X(k,t,m,r,c,y){return n(),i("div",null,[e("div",j,[t[4]||(t[4]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-2"}," Enter Email: ",-1)),x(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>r.email=l),id:"email",type:"text",placeholder:"Enter Email",class:"p-2 border border-gray-300 rounded w-full mb-2"},null,512),[[I,r.email]]),t[5]||(t[5]=e("label",{for:"orderId",class:"block text-sm font-medium text-gray-700 mb-2"}," Enter Order ID: ",-1)),x(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>r.orderId=l),id:"orderId",type:"text",placeholder:"Enter Order ID",class:"p-2 border border-gray-300 rounded w-full mb-2"},null,512),[[I,r.orderId]]),e("button",{onClick:t[2]||(t[2]=(...l)=>r.fetchOrder&&r.fetchOrder(...l)),class:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600 mt-2 mr-2"}," Fetch Order "),e("button",{onClick:t[3]||(t[3]=(...l)=>r.clearOrder&&r.clearOrder(...l)),class:"p-2 bg-gray-500 text-white rounded hover:bg-gray-600 mt-2"}," Clear Order ")]),r.orderData?(n(),i("div",z,[t[16]||(t[16]=e("h2",{class:"text-lg font-bold mb-4"},"Order Details",-1)),e("p",null,[t[6]||(t[6]=e("strong",null,"Order ID:",-1)),S(" "+a(r.orderData.orderId),1)]),e("p",null,[t[7]||(t[7]=e("strong",null,"User Name:",-1)),S(" "+a(r.orderData.userName||"Guest"),1)]),e("p",null,[t[8]||(t[8]=e("strong",null,"Email Address:",-1)),S(" "+a(r.orderData.emailAddress),1)]),e("p",null,[t[9]||(t[9]=e("strong",null,"Order Status:",-1)),S(" "+a(r.getOrderStatus(r.orderData.orderStatus)),1)]),e("p",null,[t[10]||(t[10]=e("strong",null,"Time Slot:",-1)),S(" "+a(r.formatDate(r.orderData.timeSlot)),1)]),t[17]||(t[17]=e("h3",{class:"text-md font-bold mt-4 mb-2"},"Order Items",-1)),e("ul",null,[(n(!0),i(D,null,U(r.orderData.orderItems,(l,p)=>(n(),i("li",{key:p,class:"mb-4 border-b border-gray-200 pb-2"},[e("p",null,[t[11]||(t[11]=e("strong",null,"Ticket ID:",-1)),S(" "+a(l.ticketId),1)]),e("p",null,[t[12]||(t[12]=e("strong",null,"Quantity:",-1)),S(" "+a(l.quantity),1)]),e("p",null,[t[13]||(t[13]=e("strong",null,"Price:",-1)),S(" $"+a(l.price.toFixed(2)),1)]),e("p",null,[t[14]||(t[14]=e("strong",null,"Base URL:",-1)),e("a",{href:l.baseUrl,target:"_blank",class:"text-blue-500 underline"},a(l.baseUrl),9,H)])]))),128))]),e("p",J,[t[15]||(t[15]=e("strong",null,"Payment URL:",-1)),e("a",{href:r.orderData.paymentUrl,target:"_blank",class:"text-blue-500 underline"},a(r.orderData.paymentUrl),9,K)])])):r.errorMessage?(n(),i("div",W,a(r.errorMessage),1)):E("",!0)])}const Y=_(R,[["render",X],["__scopeId","data-v-2a301af9"]]),Z={class:"mb-4"},ee={key:0,class:"mt-6"},te={key:1,class:"mt-4 text-red-500"},re={key:2,class:"mt-4 text-red-500"},le={__name:"GetOrdersByEmail",setup(k){const t=T(),m=g(""),r=g([]),c=g(null),y=g(!1);async function l(){if(!m.value){c.value="Email is required.",r.value=[],y.value=!1;return}try{c.value=null,r.value=await t.getOrdersByEmail(m.value),y.value=!0}catch(o){console.error(o),c.value=o.message||"Failed to fetch orders. Please try again.",r.value=[],y.value=!1}}function p(o){return["Pending","Completed","Canceled"][o]||"Unknown"}function d(o){const s={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(o).toLocaleDateString(void 0,s)}return(o,s)=>(n(),i("div",null,[s[3]||(s[3]=e("h1",{class:"text-lg font-bold mb-4"},"Orders",-1)),e("div",Z,[s[1]||(s[1]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-2"}," Enter Email: ",-1)),x(e("input",{"onUpdate:modelValue":s[0]||(s[0]=b=>m.value=b),id:"email",type:"text",placeholder:"Enter Email",class:"p-2 border border-gray-300 rounded w-full mb-2"},null,512),[[I,m.value]]),e("button",{onClick:l,class:"p-2 bg-blue-500 text-white rounded hover:bg-blue-600 mt-2"}," Fetch Orders ")]),r.value.length>0?(n(),i("div",ee,[F(G,null,{"table-header":A(()=>s[2]||(s[2]=[e("th",null,"Order ID",-1),e("th",null,"User Name",-1),e("th",null,"Email",-1),e("th",null,"Status",-1),e("th",null,"Time Slot",-1),e("th",null,"Items",-1)])),default:A(()=>[(n(!0),i(D,null,U(r.value,(b,w)=>(n(),M(L,{key:w},{default:A(()=>[e("td",null,a(b.orderId),1),e("td",null,a(b.userName||"Guest"),1),e("td",null,a(b.emailAddress),1),e("td",null,a(p(b.orderStatus)),1),e("td",null,a(d(b.timeSlot)),1),e("td",null,[e("ul",null,[(n(!0),i(D,null,U(b.orderItems,(h,O)=>(n(),i("li",{key:O}," Ticket ID: "+a(h.ticketId)+", Qty: "+a(h.quantity)+", Price: $"+a(h.price.toFixed(2)),1))),128))])])]),_:2},1024))),128))]),_:1})])):y.value&&r.value.length===0?(n(),i("div",te," No orders found for the provided email. ")):c.value?(n(),i("div",re,a(c.value),1)):E("",!0)]))}},se=_(le,[["__scopeId","data-v-54144ef7"]]),ae={class:"mb-4"},de={class:"mb-4"},oe={key:0},ne={class:"w-full table-auto border border-gray-300"},ue={class:"p-2 border"},ie={class:"p-2 border"},me={class:"p-2 border"},ce={class:"p-2 border"},pe={class:"p-2 border"},ve=["max","onUpdate:modelValue"],be={class:"p-2 border"},ge=["onClick"],fe={key:1,class:"text-gray-500"},ye={key:0,class:"mb-4"},Oe=["onClick"],ke={key:1,class:"mt-4 text-green-500"},xe={key:2,class:"mt-4 text-red-500"},Se={__name:"CreateOrder",setup(k){const t=g(""),m=g(""),r=g(""),c=g([]),y=g({}),l=g([]),p=g(null),d=g(null),o=Q(),s=T();N(async()=>{try{await o.fetchTickets(),c.value=o.tickets}catch{d.value="Failed to fetch tickets."}});function b(O){const u=y.value[O.id];if(!u||u<1||u>O.stock){d.value="Invalid quantity selected.";return}if(l.value.find(f=>f.ticket.id===O.id)){d.value="Ticket already added to the order.";return}l.value.push({ticket:O,quantity:u}),y.value[O.id]=0,d.value=null}function w(O){l.value.splice(O,1)}async function h(){var u,v;if(!t.value){d.value="Email is required.";return}if(l.value.length===0){d.value="At least one ticket is required to create an order.";return}if(!r.value){d.value="Time Slot is required.";return}const O={emailAddress:t.value,userName:m.value||null,timeSlot:new Date(r.value).toISOString(),orderItems:l.value.map(f=>({ticketId:f.ticket.id,quantity:f.quantity,price:f.ticket.price}))};try{const f=await s.createOrder(O);p.value=`Order created successfully! Order ID: ${f.id}`,d.value=null,resetForm()}catch(f){console.error("Failed to create the order:",f),d.value=((v=(u=f.response)==null?void 0:u.data)==null?void 0:v.message)||"Failed to create the order.",p.value=null}}return(O,u)=>(n(),i("div",null,[u[9]||(u[9]=e("h1",{class:"text-lg font-bold mb-4"},"Create Order",-1)),e("div",ae,[u[3]||(u[3]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-2"}," Enter Email (Required): ",-1)),x(e("input",{"onUpdate:modelValue":u[0]||(u[0]=v=>t.value=v),id:"email",type:"text",placeholder:"Enter Email",class:"p-2 border border-gray-300 rounded w-full mb-4"},null,512),[[I,t.value]]),u[4]||(u[4]=e("label",{for:"userName",class:"block text-sm font-medium text-gray-700 mb-2"}," Enter User Name (Optional): ",-1)),x(e("input",{"onUpdate:modelValue":u[1]||(u[1]=v=>m.value=v),id:"userName",type:"text",placeholder:"Enter User Name",class:"p-2 border border-gray-300 rounded w-full mb-4"},null,512),[[I,m.value]]),u[5]||(u[5]=e("label",{for:"timeSlot",class:"block text-sm font-medium text-gray-700 mb-2"}," Select Time Slot (UTC): ",-1)),x(e("input",{"onUpdate:modelValue":u[2]||(u[2]=v=>r.value=v),id:"timeSlot",type:"datetime-local",class:"p-2 border border-gray-300 rounded w-full mb-4"},null,512),[[I,r.value]])]),e("div",de,[u[7]||(u[7]=e("h2",{class:"text-md font-bold mb-2"},"Select Tickets",-1)),c.value.length>0?(n(),i("div",oe,[e("table",ne,[u[6]||(u[6]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"p-2 border"},"ID"),e("th",{class:"p-2 border"},"Title"),e("th",{class:"p-2 border"},"Price"),e("th",{class:"p-2 border"},"Stock"),e("th",{class:"p-2 border"},"Quantity"),e("th",{class:"p-2 border"},"Action")])],-1)),e("tbody",null,[(n(!0),i(D,null,U(c.value,v=>(n(),i("tr",{key:v.id},[e("td",ue,a(v.id),1),e("td",ie,a(v.title),1),e("td",me,"$"+a(v.price),1),e("td",ce,a(v.stock),1),e("td",pe,[x(e("input",{type:"number",min:"1",max:v.stock,"onUpdate:modelValue":f=>y.value[v.id]=f,placeholder:"Quantity",class:"p-1 border border-gray-300 rounded w-16"},null,8,ve),[[I,y.value[v.id],void 0,{number:!0}]])]),e("td",be,[e("button",{onClick:f=>b(v),class:"p-1 bg-blue-500 text-white rounded hover:bg-blue-600"}," Add ",8,ge)])]))),128))])])])):(n(),i("div",fe,"Loading tickets..."))]),l.value.length>0?(n(),i("div",ye,[u[8]||(u[8]=e("h2",{class:"text-md font-bold mb-2"},"Selected Tickets",-1)),e("ul",null,[(n(!0),i(D,null,U(l.value,(v,f)=>(n(),i("li",{key:f,class:"mb-2 flex justify-between items-center"},[e("div",null,[e("strong",null,a(v.ticket.title),1),S(" (ID: "+a(v.ticket.id)+") - Quantity: "+a(v.quantity)+" - Price: $ "+a((v.quantity*v.ticket.price).toFixed(2)),1)]),e("button",{onClick:Fe=>w(f),class:"p-1 bg-red-500 text-white rounded hover:bg-red-600"}," Remove ",8,Oe)]))),128))])])):E("",!0),e("button",{onClick:h,class:"p-2 bg-green-500 text-white rounded hover:bg-green-600"}," Submit Order "),p.value?(n(),i("div",ke,a(p.value),1)):E("",!0),d.value?(n(),i("div",xe,a(d.value),1)):E("",!0)]))}},Ie=_(Se,[["__scopeId","data-v-9e69b87d"]]),he={name:"UpdateOrderStatus",setup(){const k=T(),t=g({orderId:"",emailAddress:"",status:0}),m={0:"Pending",1:"Processing",2:"Completed",3:"Cancelled"},r=g(""),c=g("");return{form:t,statuses:m,errorMessage:r,successMessage:c,updateStatus:async()=>{var l,p;try{r.value="",c.value="";const d=await k.updateOrderStatus(t.value.orderId,{orderId:t.value.orderId,emailAddress:t.value.emailAddress,status:t.value.status});c.value=`Order ID ${d.id} status updated successfully to ${m[t.value.status]}.`,t.value.orderId="",t.value.emailAddress="",t.value.status=0}catch(d){r.value=((p=(l=d.response)==null?void 0:l.data)==null?void 0:p.message)||"Failed to update the order status."}}}}},Ee={class:"update-order-status"},we=["value"],De={key:0,class:"error"},Ue={key:1,class:"success"};function _e(k,t,m,r,c,y){return n(),i("div",Ee,[t[8]||(t[8]=e("h1",null,"Update Order Status",-1)),e("form",{onSubmit:t[3]||(t[3]=P((...l)=>r.updateStatus&&r.updateStatus(...l),["prevent"]))},[e("div",null,[t[4]||(t[4]=e("label",{for:"orderId"},"Order ID:",-1)),x(e("input",{id:"orderId","onUpdate:modelValue":t[0]||(t[0]=l=>r.form.orderId=l),type:"text",placeholder:"Enter Order ID",required:""},null,512),[[I,r.form.orderId]])]),e("div",null,[t[5]||(t[5]=e("label",{for:"emailAddress"},"Email Address:",-1)),x(e("input",{id:"emailAddress","onUpdate:modelValue":t[1]||(t[1]=l=>r.form.emailAddress=l),type:"email",placeholder:"Enter Email Address",required:""},null,512),[[I,r.form.emailAddress]])]),e("div",null,[t[6]||(t[6]=e("label",{for:"status"},"Order Status:",-1)),x(e("select",{id:"status","onUpdate:modelValue":t[2]||(t[2]=l=>r.form.status=l),required:""},[(n(!0),i(D,null,U(r.statuses,(l,p)=>(n(),i("option",{key:p,value:p},a(l),9,we))),128))],512),[[V,r.form.status,void 0,{number:!0}]])]),t[7]||(t[7]=e("button",{type:"submit"},"Update Status",-1))],32),r.errorMessage?(n(),i("div",De,[e("p",null,a(r.errorMessage),1)])):E("",!0),r.successMessage?(n(),i("div",Ue,[e("p",null,a(r.successMessage),1)])):E("",!0)])}const Ce=_(he,[["render",_e],["__scopeId","data-v-9513cc0f"]]),Te={components:{TabComponent:q},data(){return{tabs:[{key:"getOrdersByEmailAndOrderId",label:"Get Orders By Email And Order Id"},{key:"getordersbyEmail",label:"Get Orders By Email"},{key:"createOrder",label:"CreateOrder"},{key:"updateOrderStatus",label:"Update Order Status"}],components:{getOrdersByEmailAndOrderId:Y,getordersbyEmail:se,createOrder:Ie,updateOrderStatus:Ce}}}};function Ae(k,t,m,r,c,y){const l=$("TabComponent");return n(),i("div",null,[t[0]||(t[0]=e("h1",null,"Orders",-1)),F(l,{tabs:c.tabs,components:c.components,"default-tab":"getAll"},null,8,["tabs","components"])])}const Ve=_(Te,[["render",Ae]]);export{Ve as default};
